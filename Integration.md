# Автоматизированная партнерская интеграция

В MOAB Tools есть возможность предоставлять партнерский бонус для вашей аудитории в автоматическом режиме посредством API-запроса с вашей стороны. Принцип работы такого способа следующий:

* вы по наступлению согласованного события (регистрации пользователя у вас в системе, клика пользователя по определенной ссылке, оплате пользователем какого-либо счета в вашей системе и т.п.) отправляете в MOAB Tools POST-запрос с email вашего пользователя
* email вашего пользователя попадает к нам в специальный список
* при регистрации у нас система проверяет, находится ли регистрируемый пользователь в этом списке и, при нахождении, предоставляет ему согласованный бонус

Также есть возможность автоматической регистрации вашего пользователя в нашей системе с предоставлением ему партнерского бонуса и автоматической отправкой ему данных для входа в MOAB Tools.

Также возможна привязка партнерского бонуса к партнерской программе MOAB - в этом случае вы будете получать процент от пополнений пользователей, которых вы привели при помощи партнерской интеграции.

Для согласования автоматизированной партнерской интеграции вам необходимо в свободной форме написать на адрес we@moab.pro - наши менеджеры и технические специалисты свяжутся с вами и обсудят все детали

## Техническое описание формата взаимодействия

* Метод запроса: POST
* URL запроса: http://tools.moab.pro/api/Register/Add
* Content-Type: application/json
* HTTP-статус ответа: всегда 200
* Кодировка: UTF-8

Тело запроса:

```javascript
{ api_key : "ваш_api_ключ", email : "test@test.ru" }
```

Здесь:
* ваш_api_ключ - строка вида GUID, которая предоставляется вам на этапе согласования партнеской интеграции; не имеет отношения к API-ключу в личном кабинете пользователя tools.moab.pro
* test@test.ru - email пользователя, которому необходимо предоставить бонус

Тело ответа:

```javascript
{ status: "ok" }
```

или

```javascript
{ status: "fail", error: код_ошибки }
```

Здесь:
* status - "ok" если всё в порядке; "fail" - если произошла ошибка
* error - код ошибки (int); таблицу ошибок смотрите в конце этого текста

Рекомендуется ставить таймаут запроса не менее 15 сек во избежание ошибок соединения с сервисом.

## Таблица ошибок

Код ошибки  | Описание ошибки
------------- | -------------
1  | Не переданы данные
2  | Не передан ключ API
3  | Ключ API передан в неверном формате
4  | Не передан email
5  | Передан неверный email
6  | Не найден партнер
7  | Дата начала акции еще не наступила
8  | Акция уже завершилась
9  | Достигнуто максимальное количество пользователей
10  | Пользователь с таким email уже был передан
11  | Ошибка при добавлении пользователя
